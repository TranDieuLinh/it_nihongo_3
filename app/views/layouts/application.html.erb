<!DOCTYPE html>
<html>
  <head>
    <title>GameReview</title>
    <%= csrf_meta_tags %>
    <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= stylesheet_link_tag  'games', media: 'all', 'data-turbolinks-track': 'reload' if params[:controller]== "games" %>
    <%= stylesheet_link_tag 'devise', media: 'all', 'data-turbolinks-track': 'reload' if params[:controller] == 'devise/sessions' %>
    <%= stylesheet_link_tag 'devise', media: 'all', 'data-turbolinks-track': 'reload' if params[:controller] == 'devise/confirmations' %>
    <%= stylesheet_link_tag 'devise', media: 'all', 'data-turbolinks-track': 'reload' if params[:controller] == 'devise/passwords' %>
    <%= stylesheet_link_tag 'devise', media: 'all', 'data-turbolinks-track': 'reload' if (params[:controller] == 'users/registrations' && (params[:action] == "new" || params[:action] == "create")) %>
    <%= stylesheet_link_tag 'profile', media: 'all', 'data-turbolinks-track': 'reload' if (params[:controller] == 'users' && params[:action] == "show") %>
    <%= stylesheet_link_tag 'show_game', media: 'all', 'data-turbolinks-track': 'reload' if (params[:controller] == 'games' && params[:action] == "show") %>
    <%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %>
    <%= javascript_include_tag 'profile' if (params[:controller] == 'users' && params[:action] == "show")%>
    <%= stylesheet_link_tag 'static_pages', media: 'all', 'data-turbolinks-track': 'reload' if params[:controller] == 'static_pages' %>
    <%= stylesheet_link_tag 'reviews', media: 'all', 'data-turbolinks-track': 'reload' if params[:controller] == 'reviews' %>
    <%= javascript_include_tag 'reviews' if params[:controller]== "reviews" %>
    <%= stylesheet_link_tag 'admin', media: 'all', 'data-turbolinks-track': 'reload' if params[:controller] == 'admin' %>
    <%= stylesheet_link_tag 'admin_create_game', media: 'all', 'data-turbolinks-track': 'reload' if (params[:controller] == 'admin' && params[:action] == "create_game") %>
    <%= javascript_include_tag 'admin_game' if params[:controller]== "admin" && params[:action] == "create_game" %>
     <%= stylesheet_link_tag 'home_page', media: 'all', 'data-turbolinks-track': 'reload' if params[:controller] == 'home_page' %>
     <%= javascript_include_tag 'home_page' if (params[:controller] == 'home_page')%>
  </head>
  <% if current_user.present? && current_user.is_admin? && params[:controller]== "admin" %>
     <%= render 'admin/navigation' %>
  <% else %> 
   
  <body class="body">
  <div class="overlay">
    <nav class="navbar navbar-inverse">
      <div class="container-fluid">
        <div class="navbar-header">
          <%= link_to "ゲームセンター", root_path, :class => "navbar-brand" %>
        </div>
        <ul class="nav navbar-nav">
          <% if current_user.present? && current_user.is_admin? %>
          <li>
            <a href="/admin">Admin</a>
          </li>
          <% end %>
          <li><a href="<%= games_path %>">Game</a></li>
          <li><a href="<%= reviews_path %>">Review</a></li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
          <li id="search-container">
            <div id="search-form">
              <form>
                <input value="" id="search-input" type="search" placeholder="Search">
              </form>
            </div>
            <div class="search-result">
              <div class="search-header">
                <p>Search result</p>
              </div>
              <ul id="list-item-result">
                <li class="row"><span>Result</span></li>
              </ul>
            </div>
          </li>
          <% if current_user.present? %>
              <li class="notifications">
                <%= link_to notifications_path, class: "notifications-icon", method: :put, remote: true do %>
                  <i class="fa fa-bell"></i>
                  <% counter = current_user.notifications.filter_not_seen.count %>
                  <div class="counter" style="display: <%= counter == 0? 'none': 'block'%>"><%= counter%></div>
                <% end %>
                <div class="box">
                  <div class="header">
                    <p>Notification</p>
                  </div>
                  <ul class="list-detail">
                    <%= render "notifications/list_in_top", user: current_user%>
                  </ul>
                </div>
              </li>
              <li>
                <a class="dropdown-toggle" data-toggle="dropdown"><%= image_tag current_user.avatar.thumb.url || "default-user.jpg", class: "avatar-user"%><%= current_user.name %>
                    <span class="caret"></span></a>
                  <ul class="dropdown-menu">
                    <li data-no-turbolink><a href="#"><%= link_to('My Profile', user_path(current_user), method: :get) %></a></li>
                    <li><a href="#"><%= link_to('Logout', destroy_user_session_path, method: :delete) %></a></li>
                  </ul>
              </li>
          <%else%>
              <li> <%= link_to "Sign up", new_user_registration_path %><br /></li>
              <li> <%= link_to "Log in", new_user_session_path %></li>
          <% end %>
        </ul>
      </div>
    </nav>
    <% flash.each do |key, value| %>
        <% if value.is_a?(Array) %>
            <% value.each do |error| %>
                <div class="<%= flash_class(key)%>"><%= error %></div>
            <% end %>
          <% else %>
            <div class="<%= flash_class(key)%>"><%= value %></div>
        <% end %>
    <% end %>
    <%= yield %>
  </div>
  </body>
   <% end %> 
</html>
